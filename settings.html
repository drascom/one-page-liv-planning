<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Settings · API Tokens</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>

<body class="patient-page">
  <header class="patient-header">
    <a href="/" class="back-link">← Back to schedule</a>
    <button type="button" class="logout-link" data-logout-btn>Logout</button>
    <div class="patient-heading">
      <p class="patient-week">Integration</p>
      <h1>API Tokens</h1>
      <p class="patient-city">Create tokens to connect external systems.</p>
    </div>
  </header>

  <main class="patient-content settings-content">
    <div class="settings-shell">
      <aside class="settings-menu" role="tablist" aria-label="Settings sections">
        <div class="settings-menu__group">
          <p class="settings-menu__label">Workspace</p>
          <button type="button" class="settings-tab" id="settings-tab-options" role="tab" aria-selected="false"
            aria-controls="settings-panel-options" data-settings-tab="options">
            <span class="settings-tab__title">Dropdown Options</span>
            <span class="settings-tab__subtitle">Forms, statuses &amp; more</span>
          </button>
          <button type="button" class="settings-tab" id="settings-tab-users" role="tab" aria-selected="false"
            aria-controls="settings-panel-users" data-settings-tab="users">
            <span class="settings-tab__title">Team Access</span>
            <span class="settings-tab__subtitle">Manage user roles</span>
          </button>
        </div>
        <div class="settings-menu__group">
          <p class="settings-menu__label">Integrations</p>
          <button type="button" class="settings-tab is-active" id="settings-tab-tokens" role="tab" aria-selected="true"
            aria-controls="settings-panel-tokens" data-settings-tab="tokens">
            <span class="settings-tab__title">API Tokens</span>
            <span class="settings-tab__subtitle">Connect external tools</span>
          </button>
        </div>
      </aside>

      <div class="settings-panels">
        <section class="settings-section" id="settings-panel-tokens" role="tabpanel"
          aria-labelledby="settings-tab-tokens" data-settings-section="tokens">
          <header class="settings-section__header">
            <p class="settings-section__eyebrow">Integration</p>
            <h2>API Tokens</h2>
            <p>Generate secure keys for no-code tools, analytics, and internal automations.</p>
          </header>
          <div class="settings-section__grid">
            <section class="patient-card">
              <h3>Create Token</h3>
              <form id="token-form" class="patient-form">
                <div class="form-grid">
                  <label class="form-field">
                    <span>Token Name</span>
                    <input id="token-name" name="tokenName" type="text" placeholder="e.g. Zapier workflow" required />
                  </label>
                </div>
                <div class="form-actions">
                  <button type="submit" class="primary-btn" id="create-token-btn">Generate Token</button>
                  <span id="token-status" class="form-status" role="status"></span>
                </div>
              </form>
              <p class="upload-status">Tokens never expire. Copy and store them securely.</p>
            </section>

            <section class="patient-card">
              <h3>Existing Tokens</h3>
              <div class="token-list" id="token-list"></div>
              <p class="token-test">
                Need to validate your integration? Open the
                <a id="token-test-link" href="#" target="_blank" rel="noreferrer">patient search tester</a>
                to run `/api/v1/search` with your token.
              </p>
            </section>
          </div>
        </section>

        <section class="settings-section" id="settings-panel-options" role="tabpanel"
          aria-labelledby="settings-tab-options" data-settings-section="options" hidden>
          <header class="settings-section__header">
            <p class="settings-section__eyebrow">Workspace</p>
            <h2>Dropdown Options</h2>
            <p>Control every list that appears on the schedule and patient form.</p>
          </header>
          <section class="patient-card">
            <div id="field-options-container" class="option-forms"></div>
          </section>
        </section>

        <section class="settings-section" id="settings-panel-users" role="tabpanel" aria-labelledby="settings-tab-users"
          data-settings-section="users" hidden>
          <header class="settings-section__header">
            <p class="settings-section__eyebrow">Workspace</p>
            <h2>Team Access</h2>
            <p>Invite new teammates, give admin rights, and reset credentials.</p>
          </header>
          <section class="patient-card">
            <h3>User Management</h3>
            <p class="upload-status">Add or remove teammates and reset passwords.</p>
            <div id="user-admin" class="user-admin" hidden>
              <ul id="user-list" class="user-list"></ul>
              <form id="user-form" class="user-form">
                <div class="user-form__fields">
                  <input id="new-username" type="text" placeholder="Username" required />
                  <input id="new-password" type="password" placeholder="Password" required />
                  <label class="user-form__checkbox">
                    <input id="new-is-admin" type="checkbox" /> Admin
                  </label>
                </div>
                <button type="submit" class="primary-btn">Add user</button>
                <span id="user-form-status" class="form-status" aria-live="polite"></span>
              </form>
            </div>
            <p class="upload-status" id="user-admin-warning"></p>
          </section>
        </section>
      </div>
    </div>
  </main>

  <script src="/app-config.js"></script>
  <script src="/static/settings.js" type="module"></script>
</body>

</html>
