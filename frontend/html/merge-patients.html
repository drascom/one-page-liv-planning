<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Combine Patient Records</title>
  <link rel="stylesheet" href="/static/css/styles.css" />
  <link rel="icon" type="image/svg+xml" href="/static/img/favicon.svg" />
</head>

<body class="patient-page app-shell merge-page">
  <div class="app-layout">
    <nav class="top-nav top-nav--subpage">
      <div class="top-nav__brand">
        <a class="top-nav__brand-link" href="/dashboard">
          <span class="top-nav__brand-icon" aria-hidden="true">‚ùñ</span>
          <span class="top-nav__brand-text">
            <span class="top-nav__brand-name">Liv Planner</span>
            <span class="top-nav__version" data-app-version>Version dev</span>
          </span>
          <span class="connection-indicator" id="connection-indicator" aria-hidden="true"></span>
        </a>
        <span class="top-nav__divider" aria-hidden="true">‚Ä¢</span>
        <span class="top-nav__section">Merge Patients</span>
      </div>
      <div class="top-nav__actions">
        <a class="nav-btn nav-btn--ghost" href="/schedule" aria-label="Schedule">
          <svg class="nav-btn__icon" aria-hidden="true" focusable="false">
            <use href="/static/img/nav-icons.svg#icon-schedule"></use>
          </svg>
          <span class="nav-btn__label">Schedule</span>
        </a>
        <a class="nav-btn nav-btn--ghost" href="/customers" aria-label="Customers">
          <svg class="nav-btn__icon" aria-hidden="true" focusable="false">
            <use href="/static/img/nav-icons.svg#icon-customers"></use>
          </svg>
          <span class="nav-btn__label">Customers</span>
        </a>
        <a class="nav-btn nav-btn--ghost" href="/settings" data-admin-link hidden aria-label="Settings">
          <svg class="nav-btn__icon" aria-hidden="true" focusable="false">
            <use href="/static/img/nav-icons.svg#icon-settings"></use>
          </svg>
          <span class="nav-btn__label">Settings</span>
        </a>
        <button type="button" class="nav-btn nav-btn--primary" data-logout-btn aria-label="Logout">
          <svg class="nav-btn__icon" aria-hidden="true" focusable="false">
            <use href="/static/img/nav-icons.svg#icon-logout"></use>
          </svg>
          <span class="nav-btn__label">Logout</span>
        </button>
      </div>
    </nav>

    <main class="patient-content merge-content">
      <section class="patient-card merge-card">
        <header class="merge-card__header">
          <div>
            <p class="settings-section__eyebrow">Data hygiene</p>
            <h1>Combine patient records</h1>
            <p class="merge-card__lede">
              Select duplicate patients, choose the record to keep, and move every procedure, payment, and file into a
              single profile.
            </p>
          </div>
          <div class="merge-card__stats">
            <div class="merge-card__stat">
              <span class="merge-card__stat-value" id="merge-selected-count">0</span>
              <span class="merge-card__stat-label">Selected</span>
            </div>
            <div class="merge-card__stat">
              <span class="merge-card__stat-value" id="merge-procedure-count">0</span>
              <span class="merge-card__stat-label">Procedures</span>
            </div>
          </div>
        </header>

        <p id="merge-status" class="form-status" role="status"></p>

        <div class="merge-grid">
          <div class="merge-stack">


            <section class="merge-panel">
              <header class="merge-panel__header">
                <div>
                  <p class="settings-section__eyebrow">Add patients</p>
                  <h2>Pick records to combine</h2>
                </div>
                <p class="merge-panel__hint merge-panel__hint--inline">Select patients to highlight them below.</p>
              </header>
              <label class="visually-hidden" for="merge-add-search">Search patients to add</label>
              <div class="merge-search">
                <span class="search-icon" aria-hidden="true">üîç</span>
                <input id="merge-add-search" type="search" placeholder="Find a patient by name, email, or address"
                  class="search-input" enterkeyhint="search" />
              </div>
              <ul id="merge-directory-list" class="customer-list merge-directory-list" aria-live="polite"></ul>
            </section>
          </div>
          <section class="merge-panel">
            <header class="merge-panel__header">
              <div>
                <p class="settings-section__eyebrow">Selections</p>
                <h2>Selected patients</h2>
              </div>
              <button type="button" class="ghost-btn ghost-btn--small" id="merge-clear-btn">Clear</button>
            </header>
            <p class="merge-panel__hint">Choose at least two patients. Pick which record to keep.</p>
            <ul id="merge-selected-list" class="merge-selected-list"></ul>
            <div class="merge-panel__footer">
              <button type="button" class="secondary-btn" id="merge-open-directory">Back to directory</button>
              <button type="button" class="ghost-btn" id="merge-open-customers">View schedule</button>
            </div>
          </section>
          <section class="merge-panel merge-panel--form">
            <header class="merge-panel__header">
              <div>
                <p class="settings-section__eyebrow">Surviving record</p>
                <h2>Keep this patient</h2>
              </div>
              <p class="merge-panel__hint merge-panel__hint--inline">We‚Äôll move everything into this patient record.</p>
            </header>

            <form id="merge-form" class="form-layout merge-form">
              <div class="form-group">
                <label for="merge-first-name">First Name</label>
                <input id="merge-first-name" name="firstName" type="text" autocomplete="given-name" required />
              </div>
              <div class="form-group">
                <label for="merge-last-name">Last Name</label>
                <input id="merge-last-name" name="lastName" type="text" autocomplete="family-name" required />
              </div>
              <div class="form-group">
                <label for="merge-email">Email</label>
                <input id="merge-email" name="email" type="email" autocomplete="email" required />
              </div>
              <div class="form-group">
                <label for="merge-phone">Phone</label>
                <input id="merge-phone" name="phone" type="tel" autocomplete="tel" required />
              </div>
              <div class="form-group">
                <label for="merge-address">Address</label>
                <input id="merge-address" name="address" type="text" autocomplete="street-address" required />
              </div>
              <div class="form-group">
                <label for="merge-drive">Drive Folder ID (optional)</label>
                <input id="merge-drive" name="driveFolderId" type="text" autocomplete="off" />
              </div>

              <div class="merge-summary">
                <div>
                  <p class="merge-summary__label">Patients merging</p>
                  <p class="merge-summary__value" id="merge-summary-count">0</p>
                </div>
                <div>
                  <p class="merge-summary__label">Procedures moving</p>
                  <p class="merge-summary__value" id="merge-summary-procedures">0</p>
                </div>
                <div>
                  <p class="merge-summary__label">Photos moving</p>
                  <p class="merge-summary__value" id="merge-summary-photos">0</p>
                </div>
              </div>

              <div class="merge-actions">
                <button type="submit" class="primary-btn" id="merge-submit-btn">Merge patients</button>
                <button type="button" class="secondary-btn" id="merge-view-patient" hidden>Open merged record</button>
              </div>
            </form>
          </section>
        </div>
      </section>
    </main>
  </div>

  <script src="/app-config.js"></script>
  <script src="/static/js/nav-connection.js" type="module"></script>
  <script src="/static/js/merge-patients.js" type="module"></script>
</body>

</html>